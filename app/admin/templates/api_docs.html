{% extends "base.html" %}

{% block title %}API Reference{% endblock %}

{% block content %}
<div x-data="apiDocsData()" x-init="init()">
    <!-- Header -->
    <div class="px-4 sm:px-0 mb-8">
        <h1 class="text-4xl font-bold text-gray-900">API Reference</h1>
        <p class="mt-2 text-lg text-gray-600">Complete guide to integrating with your FastCMS backend</p>
    </div>

    <!-- Quick Navigation -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <a href="#authentication" class="bg-blue-50 border-2 border-blue-200 rounded-lg p-6 hover:bg-blue-100 transition">
            <div class="flex items-center">
                <i class="fas fa-key text-3xl text-blue-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Authentication</h3>
                    <p class="text-sm text-gray-600">Login & Register</p>
                </div>
            </div>
        </a>

        <a href="#users" class="bg-purple-50 border-2 border-purple-200 rounded-lg p-6 hover:bg-purple-100 transition">
            <div class="flex items-center">
                <i class="fas fa-users text-3xl text-purple-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Users</h3>
                    <p class="text-sm text-gray-600">User Management</p>
                </div>
            </div>
        </a>

        <a href="#collections" class="bg-green-50 border-2 border-green-200 rounded-lg p-6 hover:bg-green-100 transition">
            <div class="flex items-center">
                <i class="fas fa-database text-3xl text-green-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Collections</h3>
                    <p class="text-sm text-gray-600">Dynamic Data</p>
                </div>
            </div>
        </a>

        <a href="#files" class="bg-orange-50 border-2 border-orange-200 rounded-lg p-6 hover:bg-orange-100 transition">
            <div class="flex items-center">
                <i class="fas fa-file text-3xl text-orange-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Files</h3>
                    <p class="text-sm text-gray-600">File Storage</p>
                </div>
            </div>
        </a>

        <a href="#webhooks" class="bg-indigo-50 border-2 border-indigo-200 rounded-lg p-6 hover:bg-indigo-100 transition">
            <div class="flex items-center">
                <i class="fas fa-webhook text-3xl text-indigo-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Webhooks</h3>
                    <p class="text-sm text-gray-600">Event Callbacks</p>
                </div>
            </div>
        </a>

        <a href="#backups" class="bg-teal-50 border-2 border-teal-200 rounded-lg p-6 hover:bg-teal-100 transition">
            <div class="flex items-center">
                <i class="fas fa-hdd text-3xl text-teal-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Backups</h3>
                    <p class="text-sm text-gray-600">Data Protection</p>
                </div>
            </div>
        </a>

        <a href="#oauth" class="bg-pink-50 border-2 border-pink-200 rounded-lg p-6 hover:bg-pink-100 transition">
            <div class="flex items-center">
                <i class="fas fa-shield-alt text-3xl text-pink-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">OAuth</h3>
                    <p class="text-sm text-gray-600">Social Login</p>
                </div>
            </div>
        </a>

        <a href="#settings" class="bg-gray-50 border-2 border-gray-200 rounded-lg p-6 hover:bg-gray-100 transition">
            <div class="flex items-center">
                <i class="fas fa-cog text-3xl text-gray-600 mr-4"></i>
                <div>
                    <h3 class="font-semibold text-gray-900">Settings</h3>
                    <p class="text-sm text-gray-600">Configuration</p>
                </div>
            </div>
        </a>
    </div>

    <!-- Base URL -->
    <div class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Base URL</h2>
        <div class="bg-gray-900 rounded-lg p-4">
            <code class="text-green-400 text-lg" x-text="baseUrl"></code>
        </div>
        <p class="mt-4 text-gray-600">All API endpoints are relative to this base URL. Include the access token in the Authorization header for authenticated requests.</p>
    </div>

    <!-- Authentication Section -->
    <div id="authentication" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-key text-blue-600 mr-3"></i>
            Authentication
        </h2>
        <p class="text-gray-600 mb-6">Secure JWT-based authentication with access and refresh tokens.</p>

        <div class="space-y-6">
            <!-- Register -->
            <div class="border-l-4 border-blue-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                    <code class="text-sm">/auth/register</code>
                </div>
                <p class="text-sm text-gray-600">Create a new user account</p>
                <a href="/admin/users/api#register" class="text-sm text-blue-600 hover:text-blue-800 mt-2 inline-block">
                    View code examples �
                </a>
            </div>

            <!-- Login -->
            <div class="border-l-4 border-blue-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                    <code class="text-sm">/auth/login</code>
                </div>
                <p class="text-sm text-gray-600">Authenticate and receive tokens</p>
                <a href="/admin/users/api#login" class="text-sm text-blue-600 hover:text-blue-800 mt-2 inline-block">
                    View code examples �
                </a>
            </div>

            <!-- Refresh Token -->
            <div class="border-l-4 border-blue-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                    <code class="text-sm">/auth/refresh</code>
                </div>
                <p class="text-sm text-gray-600">Get a new access token using refresh token</p>
                <a href="/admin/users/api#refresh" class="text-sm text-blue-600 hover:text-blue-800 mt-2 inline-block">
                    View code examples �
                </a>
            </div>
        </div>
    </div>

    <!-- Users Section -->
    <div id="users" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-users text-purple-600 mr-3"></i>
            Users
        </h2>
        <p class="text-gray-600 mb-6">Manage user accounts and profiles.</p>

        <div class="space-y-6">
            <!-- Get Current User -->
            <div class="border-l-4 border-purple-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                    <code class="text-sm">/auth/me</code>
                </div>
                <p class="text-sm text-gray-600">Get current authenticated user</p>
                <a href="/admin/users/api#me" class="text-sm text-purple-600 hover:text-purple-800 mt-2 inline-block">
                    View code examples �
                </a>
            </div>

            <!-- List Users -->
            <div class="border-l-4 border-purple-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                    <code class="text-sm">/admin/users</code>
                    <span class="ml-2 text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">Admin</span>
                </div>
                <p class="text-sm text-gray-600">List all users (admin only)</p>
                <a href="/admin/users/api#list" class="text-sm text-purple-600 hover:text-purple-800 mt-2 inline-block">
                    View code examples �
                </a>
            </div>

            <!-- Update User -->
            <div class="border-l-4 border-purple-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-yellow-100 text-yellow-800 rounded mr-2">PUT</span>
                    <code class="text-sm">/users/{id}</code>
                </div>
                <p class="text-sm text-gray-600">Update user profile</p>
                <a href="/admin/users/api#update" class="text-sm text-purple-600 hover:text-purple-800 mt-2 inline-block">
                    View code examples �
                </a>
            </div>
        </div>
    </div>

    <!-- Collections Section -->
    <div id="collections" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-database text-green-600 mr-3"></i>
            Collections
        </h2>
        <p class="text-gray-600 mb-6">Dynamic collections allow you to create custom data structures.</p>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
            <p class="text-sm text-gray-700">
                <strong>Note:</strong> Each collection has its own set of CRUD endpoints. Create a collection first, then access its API reference.
            </p>
        </div>

        <div class="space-y-6">
            <!-- List Collections -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                    <code class="text-sm">/collections</code>
                </div>
                <p class="text-sm text-gray-600">List all collections</p>
            </div>

            <!-- Collection Records -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                    <code class="text-sm">/collections/{collection_name}/records</code>
                </div>
                <p class="text-sm text-gray-600">List records in a collection</p>
            </div>

            <!-- Create Record -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                    <code class="text-sm">/collections/{collection_name}/records</code>
                </div>
                <p class="text-sm text-gray-600">Create a new record</p>
            </div>

            <!-- Search Records -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-purple-100 text-purple-800 rounded mr-2">GET</span>
                        <code class="text-sm">/collections/{collection_name}/records?search={query}</code>
                    </div>
                    <button onclick="copyToClipboard('search-records')" class="text-gray-400 hover:text-gray-600 text-sm">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Full-text search across text fields (can combine with filters)</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto mb-3">
                    <pre id="search-records">curl -X GET "<span x-text="baseUrl"></span>/collections/posts/records?search=fastcms" \
  -H "Authorization: Bearer YOUR_TOKEN"</pre>
                </div>
                <p class="text-xs text-gray-500 mb-2">Combine search with filters:</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="search-with-filter">curl -X GET "<span x-text="baseUrl"></span>/collections/posts/records?search=fastcms&filter=status=published" \
  -H "Authorization: Bearer YOUR_TOKEN"</pre>
                </div>
            </div>

            <!-- Bulk Delete -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-red-100 text-red-800 rounded mr-2">POST</span>
                        <code class="text-sm">/collections/{collection_name}/records/bulk-delete</code>
                    </div>
                    <button onclick="copyToClipboard('bulk-delete')" class="text-gray-400 hover:text-gray-600 text-sm">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Delete multiple records at once (max 100)</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="bulk-delete">curl -X POST "<span x-text="baseUrl"></span>/collections/posts/records/bulk-delete" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "record_ids": ["id1", "id2", "id3"]
  }'</pre>
                </div>
            </div>

            <!-- Bulk Update -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-yellow-100 text-yellow-800 rounded mr-2">POST</span>
                        <code class="text-sm">/collections/{collection_name}/records/bulk-update</code>
                    </div>
                    <button onclick="copyToClipboard('bulk-update')" class="text-gray-400 hover:text-gray-600 text-sm">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Update multiple records with same data (max 100)</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="bulk-update">curl -X POST "<span x-text="baseUrl"></span>/collections/posts/records/bulk-update" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "record_ids": ["id1", "id2"],
    "data": {
      "status": "published",
      "featured": true
    }
  }'</pre>
                </div>
            </div>

            <!-- CSV Export -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/collections/{collection_name}/records/export/csv</code>
                    </div>
                    <button onclick="copyToClipboard('csv-export')" class="text-gray-400 hover:text-gray-600 text-sm">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Export records to CSV file</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="csv-export">curl "<span x-text="baseUrl"></span>/collections/posts/records/export/csv?filter=status=published" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -o posts_export.csv</pre>
                </div>
            </div>

            <!-- CSV Import -->
            <div class="border-l-4 border-green-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                        <code class="text-sm">/collections/{collection_name}/records/import/csv</code>
                    </div>
                    <button onclick="copyToClipboard('csv-import')" class="text-gray-400 hover:text-gray-600 text-sm">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Import records from CSV file</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="csv-import">curl -X POST "<span x-text="baseUrl"></span>/collections/posts/records/import/csv" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@posts.csv"</pre>
                </div>
            </div>

            <!-- View Your Collections -->
            <div class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                <p class="text-sm text-gray-700 mb-3">
                    <strong>Your Collections:</strong> Click on any collection to see its specific API endpoints
                </p>
                <div class="flex flex-wrap gap-2" x-show="collections.length > 0">
                    <template x-for="collection in collections" :key="collection.id">
                        <a :href="`/admin/collections/${collection.name}/api`"
                           class="inline-flex items-center px-3 py-1 bg-white border border-green-300 rounded-md text-sm text-green-700 hover:bg-green-100">
                            <i class="fas fa-code mr-2"></i>
                            <span x-text="collection.name"></span>
                        </a>
                    </template>
                </div>
                <p x-show="collections.length === 0" class="text-sm text-gray-500">
                    No collections yet. <a href="/admin/collections/new" class="text-green-600 hover:text-green-800">Create your first collection</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Files Section -->
    <div id="files" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-file text-orange-600 mr-3"></i>
            Files
        </h2>
        <p class="text-gray-600 mb-6">Upload and manage files with support for images, documents, and more.</p>

        <div class="space-y-6">
            <!-- Upload File -->
            <div class="border-l-4 border-orange-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                    <code class="text-sm">/files</code>
                </div>
                <p class="text-sm text-gray-600">Upload a file (multipart/form-data)</p>
            </div>

            <!-- List Files -->
            <div class="border-l-4 border-orange-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                    <code class="text-sm">/files</code>
                </div>
                <p class="text-sm text-gray-600">List uploaded files</p>
            </div>

            <!-- Download File -->
            <div class="border-l-4 border-orange-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                    <code class="text-sm">/files/{file_id}/download</code>
                </div>
                <p class="text-sm text-gray-600">Download a file</p>
            </div>

            <!-- Delete File -->
            <div class="border-l-4 border-orange-500 pl-4">
                <div class="flex items-center mb-2">
                    <span class="px-2 py-1 text-xs font-semibold bg-red-100 text-red-800 rounded mr-2">DELETE</span>
                    <code class="text-sm">/files/{file_id}</code>
                </div>
                <p class="text-sm text-gray-600">Delete a file</p>
            </div>
        </div>
    </div>

    <!-- Webhooks Section -->
    <div id="webhooks" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-webhook text-indigo-600 mr-3"></i>
            Webhooks
        </h2>
        <p class="text-gray-600 mb-6">Subscribe to events and receive HTTP callbacks when records are created, updated, or deleted.</p>

        <div class="space-y-6">
            <!-- Create Webhook -->
            <div class="border-l-4 border-indigo-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                        <code class="text-sm">/webhooks</code>
                    </div>
                    <button onclick="copyToClipboard('webhook-create')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Create a new webhook subscription</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="webhook-create">curl -X POST "<span x-text="baseUrl"></span>/webhooks" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://your-server.com/webhook",
    "collection_name": "posts",
    "events": ["create", "update", "delete"],
    "secret": "your-webhook-secret",
    "retry_count": 3
  }'</pre>
                </div>
            </div>

            <!-- List Webhooks -->
            <div class="border-l-4 border-indigo-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/webhooks</code>
                    </div>
                    <button onclick="copyToClipboard('webhook-list')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">List all webhooks</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="webhook-list">curl -X GET "<span x-text="baseUrl"></span>/webhooks" \
  -H "Authorization: Bearer YOUR_TOKEN"</pre>
                </div>
            </div>

            <!-- Delete Webhook -->
            <div class="border-l-4 border-indigo-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-red-100 text-red-800 rounded mr-2">DELETE</span>
                        <code class="text-sm">/webhooks/{webhook_id}</code>
                    </div>
                    <button onclick="copyToClipboard('webhook-delete')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Delete a webhook</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="webhook-delete">curl -X DELETE "<span x-text="baseUrl"></span>/webhooks/WEBHOOK_ID" \
  -H "Authorization: Bearer YOUR_TOKEN"</pre>
                </div>
            </div>

            <div class="mt-4 p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                <p class="text-sm text-gray-700">
                    <strong>Pro Tip:</strong> Webhooks include HMAC signatures for security. See the <a href="/admin/webhooks" class="text-indigo-600 hover:text-indigo-800">Webhooks page</a> for management or read <a href="https://github.com/anthropics/claude-code" class="text-indigo-600 hover:text-indigo-800">full documentation</a> for signature verification examples.
                </p>
            </div>
        </div>
    </div>

    <!-- Backups Section -->
    <div id="backups" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-hdd text-teal-600 mr-3"></i>
            Backups
        </h2>
        <p class="text-gray-600 mb-6">Create and restore database backups for disaster recovery.</p>

        <div class="space-y-6">
            <!-- Create Backup -->
            <div class="border-l-4 border-teal-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                        <code class="text-sm">/backups</code>
                    </div>
                    <button onclick="copyToClipboard('backup-create')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Create a new database backup</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="backup-create">curl -X POST "<span x-text="baseUrl"></span>/backups" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <!-- List Backups -->
            <div class="border-l-4 border-teal-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/backups</code>
                    </div>
                    <button onclick="copyToClipboard('backup-list')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">List all backups</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="backup-list">curl -X GET "<span x-text="baseUrl"></span>/backups" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <!-- Restore Backup -->
            <div class="border-l-4 border-teal-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-yellow-100 text-yellow-800 rounded mr-2">POST</span>
                        <code class="text-sm">/backups/{backup_id}/restore</code>
                    </div>
                    <button onclick="copyToClipboard('backup-restore')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Restore a backup (overwrites current database)</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="backup-restore">curl -X POST "<span x-text="baseUrl"></span>/backups/BACKUP_ID/restore" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <!-- Delete Backup -->
            <div class="border-l-4 border-teal-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-red-100 text-red-800 rounded mr-2">DELETE</span>
                        <code class="text-sm">/backups/{backup_id}</code>
                    </div>
                    <button onclick="copyToClipboard('backup-delete')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Delete a backup</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="backup-delete">curl -X DELETE "<span x-text="baseUrl"></span>/backups/BACKUP_ID" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <p class="text-sm text-gray-700">
                    <strong>Warning:</strong> Backup operations require admin authentication. Visit the <a href="/admin/backups" class="text-yellow-700 hover:text-yellow-900 font-medium">Backups page</a> for a user-friendly interface or automate backups with cron jobs.
                </p>
            </div>
        </div>
    </div>

    <!-- OAuth Section -->
    <div id="oauth" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-shield-alt text-pink-600 mr-3"></i>
            OAuth Social Login
        </h2>
        <p class="text-gray-600 mb-6">Allow users to sign in with Google, GitHub, or Microsoft accounts.</p>

        <div class="space-y-6">
            <!-- OAuth Login Flow -->
            <div class="border-l-4 border-pink-500 pl-4">
                <h3 class="font-semibold text-gray-900 mb-2">Step 1: Redirect to OAuth Provider</h3>
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/oauth/{provider}/login</code>
                    </div>
                    <button onclick="copyToClipboard('oauth-login')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Supported providers: google, github, microsoft</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto mb-3">
                    <pre id="oauth-login">&lt;!-- Simple HTML Button --&gt;
&lt;a href="<span x-text="baseUrl"></span>/oauth/google/login"&gt;
  &lt;button&gt;Sign in with Google&lt;/button&gt;
&lt;/a&gt;

&lt;a href="<span x-text="baseUrl"></span>/oauth/github/login"&gt;
  &lt;button&gt;Sign in with GitHub&lt;/button&gt;
&lt;/a&gt;

&lt;a href="<span x-text="baseUrl"></span>/oauth/microsoft/login"&gt;
  &lt;button&gt;Sign in with Microsoft&lt;/button&gt;
&lt;/a&gt;</pre>
                </div>
            </div>

            <!-- JavaScript Integration -->
            <div class="border-l-4 border-pink-500 pl-4">
                <h3 class="font-semibold text-gray-900 mb-2">Step 2: Handle OAuth Callback</h3>
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/oauth/{provider}/callback</code>
                    </div>
                    <button onclick="copyToClipboard('oauth-callback-js')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">OAuth provider redirects here with authorization code</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="oauth-callback-js">// JavaScript: Handle OAuth Redirect
function loginWithGoogle() {
  // Redirect to OAuth login
  window.location.href = '<span x-text="baseUrl"></span>/oauth/google/login';
}

// On callback page (auto-handled by FastCMS)
// FastCMS automatically:
// 1. Exchanges code for access token
// 2. Fetches user profile
// 3. Creates/updates user account
// 4. Returns JWT tokens

// Response format:
// {
//   "access_token": "eyJhbGc...",
//   "refresh_token": "eyJhbGc...",
//   "token_type": "bearer",
//   "user": {
//     "id": "uuid",
//     "email": "user@gmail.com",
//     "name": "John Doe",
//     "verified": true,
//     "oauth_provider": "google"
//   }
// }</pre>
                </div>
            </div>

            <!-- Complete Integration Example -->
            <div class="border-l-4 border-pink-500 pl-4">
                <h3 class="font-semibold text-gray-900 mb-2">Complete Frontend Integration</h3>
                <div class="flex items-center justify-between mb-2">
                    <button onclick="copyToClipboard('oauth-full-example')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Full example with token storage and redirect</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="oauth-full-example">// Complete OAuth Integration Example

// 1. Add OAuth buttons to your login page
&lt;div class="oauth-buttons"&gt;
  &lt;button onclick="loginWithGoogle()"&gt;
    &lt;img src="google-icon.svg"&gt; Sign in with Google
  &lt;/button&gt;
  &lt;button onclick="loginWithGitHub()"&gt;
    &lt;img src="github-icon.svg"&gt; Sign in with GitHub
  &lt;/button&gt;
&lt;/div&gt;

&lt;script&gt;
// 2. Redirect functions
function loginWithGoogle() {
  window.location.href = '<span x-text="baseUrl"></span>/oauth/google/login';
}

function loginWithGitHub() {
  window.location.href = '<span x-text="baseUrl"></span>/oauth/github/login';
}

// 3. Handle callback (optional manual handling)
// FastCMS automatically handles the callback and returns tokens
// If you need custom callback handling:
const urlParams = new URLSearchParams(window.location.search);
const code = urlParams.get('code');

if (code) {
  // Exchange code for tokens (handled automatically by FastCMS)
  fetch('<span x-text="baseUrl"></span>/oauth/google/callback?code=' + code)
    .then(res => res.json())
    .then(data => {
      // Store tokens
      localStorage.setItem('access_token', data.access_token);
      localStorage.setItem('refresh_token', data.refresh_token);

      // Redirect to dashboard
      window.location.href = '/dashboard';
    })
    .catch(err => {
      console.error('OAuth failed:', err);
      alert('Login failed. Please try again.');
    });
}
&lt;/script&gt;</pre>
                </div>
            </div>

            <div class="mt-4 p-4 bg-pink-50 border border-pink-200 rounded-lg">
                <p class="text-sm text-gray-700 mb-3">
                    <strong>Setup Required:</strong> Configure OAuth providers in your .env file before use:
                </p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre># .env file
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/oauth/google/callback

GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_REDIRECT_URI=http://localhost:8000/api/v1/oauth/github/callback</pre>
                </div>
                <p class="text-sm text-gray-700 mt-3">
                    See <a href="https://github.com/anthropics/claude-code" class="text-pink-600 hover:text-pink-800 font-medium">full documentation</a> for provider setup guides.
                </p>
            </div>
        </div>
    </div>

    <!-- System Settings Section -->
    <div id="settings" class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
            <i class="fas fa-cog text-gray-600 mr-3"></i>
            System Settings
        </h2>
        <p class="text-gray-600 mb-6">Manage application configuration values stored in the database.</p>

        <div class="space-y-6">
            <!-- Get All Settings -->
            <div class="border-l-4 border-gray-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/settings</code>
                    </div>
                    <button onclick="copyToClipboard('settings-get-all')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Get all settings across all categories</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="settings-get-all">curl -X GET "<span x-text="baseUrl"></span>/settings" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <!-- Get Settings by Category -->
            <div class="border-l-4 border-gray-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded mr-2">GET</span>
                        <code class="text-sm">/settings/{category}</code>
                    </div>
                    <button onclick="copyToClipboard('settings-get-category')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Get settings for a specific category (e.g., app, email, security)</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="settings-get-category">curl -X GET "<span x-text="baseUrl"></span>/settings/app" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <!-- Create/Update Setting -->
            <div class="border-l-4 border-gray-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded mr-2">POST</span>
                        <code class="text-sm">/settings</code>
                    </div>
                    <button onclick="copyToClipboard('settings-create')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Create or update a setting</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="settings-create">curl -X POST "<span x-text="baseUrl"></span>/settings" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "key": "maintenance_mode",
    "value": false,
    "category": "app",
    "description": "Enable maintenance mode"
  }'</pre>
                </div>
            </div>

            <!-- Delete Setting -->
            <div class="border-l-4 border-gray-500 pl-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center">
                        <span class="px-2 py-1 text-xs font-semibold bg-red-100 text-red-800 rounded mr-2">DELETE</span>
                        <code class="text-sm">/settings/{key}</code>
                    </div>
                    <button onclick="copyToClipboard('settings-delete')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Delete a setting by key</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="settings-delete">curl -X DELETE "<span x-text="baseUrl"></span>/settings/old_setting" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"</pre>
                </div>
            </div>

            <!-- Common Settings Examples -->
            <div class="border-l-4 border-gray-500 pl-4">
                <h3 class="font-semibold text-gray-900 mb-2">Common Settings Examples</h3>
                <div class="flex items-center justify-between mb-2">
                    <button onclick="copyToClipboard('settings-examples')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-600 mb-2">Feature flags, rate limits, and configuration</p>
                <div class="bg-gray-900 rounded-lg p-3 text-xs text-gray-100 overflow-x-auto">
                    <pre id="settings-examples"># Feature Flag Example
curl -X POST "<span x-text="baseUrl"></span>/settings" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "key": "enable_ai_features",
    "value": true,
    "category": "app",
    "description": "Enable AI features"
  }'

# Rate Limiting Example
curl -X POST "<span x-text="baseUrl"></span>/settings" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "key": "api_rate_limit",
    "value": 100,
    "category": "security",
    "description": "Max API requests per minute"
  }'

# File Upload Limit Example
curl -X POST "<span x-text="baseUrl"></span>/settings" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "key": "max_file_size",
    "value": 10485760,
    "category": "storage",
    "description": "Maximum file size in bytes (10MB)"
  }'</pre>
                </div>
            </div>

            <div class="mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                <p class="text-sm text-gray-700">
                    <strong>Categories:</strong> Settings are organized into categories like <code class="bg-gray-200 px-2 py-1 rounded text-xs">app</code>, <code class="bg-gray-200 px-2 py-1 rounded text-xs">email</code>, <code class="bg-gray-200 px-2 py-1 rounded text-xs">security</code>, <code class="bg-gray-200 px-2 py-1 rounded text-xs">storage</code>, and <code class="bg-gray-200 px-2 py-1 rounded text-xs">custom</code> for easy management.
                </p>
            </div>
        </div>
    </div>

    <!-- SDKs & Integration -->
    <div class="bg-gradient-to-r from-indigo-50 to-purple-50 border-2 border-indigo-200 rounded-lg p-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Quick Start Integration</h2>
        <p class="text-gray-700 mb-6">Get started with your frontend in minutes using these code examples.</p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-white rounded-lg p-4 border border-gray-200">
                <div class="flex items-center mb-3">
                    <i class="fab fa-js text-yellow-500 text-2xl mr-3"></i>
                    <h3 class="font-semibold">JavaScript</h3>
                </div>
                <p class="text-sm text-gray-600">Fetch API examples for web apps</p>
            </div>

            <div class="bg-white rounded-lg p-4 border border-gray-200">
                <div class="flex items-center mb-3">
                    <i class="fab fa-python text-blue-500 text-2xl mr-3"></i>
                    <h3 class="font-semibold">Python</h3>
                </div>
                <p class="text-sm text-gray-600">Requests library examples</p>
            </div>

            <div class="bg-white rounded-lg p-4 border border-gray-200">
                <div class="flex items-center mb-3">
                    <i class="fas fa-terminal text-gray-700 text-2xl mr-3"></i>
                    <h3 class="font-semibold">cURL</h3>
                </div>
                <p class="text-sm text-gray-600">Command-line examples</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function apiDocsData() {
        return {
            baseUrl: window.location.origin + '/api/v1',
            collections: [],

            async init() {
                await this.loadCollections();
            },

            async loadCollections() {
                try {
                    const response = await apiRequest('/collections');
                    this.collections = response.items || [];
                } catch (error) {
                    console.error('Failed to load collections:', error);
                }
            }
        };
    }

    function copyToClipboard(elementId) {
        const element = document.getElementById(elementId);
        const text = element.textContent;

        navigator.clipboard.writeText(text).then(() => {
            showToast('Code copied to clipboard!', 'success');
        }).catch(err => {
            console.error('Failed to copy:', err);
            showToast('Failed to copy code', 'error');
        });
    }
</script>
{% endblock %}
